{
    "componentChunkName": "component---themes-advanced-src-templates-post-query-ts",
    "path": "/impurity-criterion",
    "result": {"data":{"mdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Impurity Criterion\",\n  \"cover\": \"images/gini-vs-entropy/Thermodynamic-1st-law.png\",\n  \"coverAlt\": \"Thermodynamic 1st Law.\",\n  \"description\": \"Understanding the Decision Tree training process is key to being able to select whether your data requires the model to be trained using Entropy or Gini impurity Criterions.\",\n  \"datePublished\": \"2021-02-26\",\n  \"dateModified\": \"2021-02-26\",\n  \"category\": \"Mathematics\",\n  \"tags\": [\"Machine Learning\", \"Mathematics\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"TLDR\"), \": Gini impurity and entropy are similar in most cases, however, in practice you may find that gini impurity is faster as log values do not need to be computed. \"), mdx(\"h5\", null, \"Introduction\"), mdx(\"p\", null, \"Machine learning algorithms can be complex but in simple terms, training a machine learning model is essentially an optimization problem where training is performed to find model parameters (i.e. weights and hyperparameters) that reduce the cost function.\"), mdx(\"p\", null, \"The cost function is the summation of the loss function across the entire dataset. The \\u201Closs\\u201D is the error from the true value (i.e. target) to the model\\u2019s predicted value, for example, the root mean squared error for regression or binary cross-entropy loss for classification problems. Obviously, the aim is to have a model that accurately predicts the target value for the majority of the dataset (or be as close to as possible for regression), therefore, the aim is to minimise the cost function tuning the weights using gradient descent. This is why training a machine learning model takes a while, especially for complex datasets that are within multiple dimensional spaces.\"), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"768px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/fe7b45127218fe99c3812c9543e7a326/2cefc/residual-errors.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"41.14583333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQY01WR245EIQgE5/+/dJ72KCACNrg5l5nsVngyFnbH18KysMrKD2bm7ma29yaiox0A9t5VtdbCxb54xQoxyUwAmekRrTVmMvPM7L0fxyNnJhMx0ZDxyBYmk28ZyIg4jh8RqSoAYwwiioj7du2a06rqkYdJ16OyFhYPGirmfpsAVLV3UlVced2dmdcFgJf6IG1mJoPd3SM8/Nvt+4iwyBAier/fqlNV3f3qPAlYyIVEnGZk4u5BdDa6fQCtNRFR1XvpKXdmlRBx6rM3ZbIhLuw2V+3KrJvMJOLrL+zpDGDFCj+HaVKfU/0++WT/l/8vv7tV09nHrKMMAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Residual Errors\",\n    \"title\": \"Residual Errors\",\n    \"src\": \"/static/fe7b45127218fe99c3812c9543e7a326/e5715/residual-errors.png\",\n    \"srcSet\": [\"/static/fe7b45127218fe99c3812c9543e7a326/8514f/residual-errors.png 192w\", \"/static/fe7b45127218fe99c3812c9543e7a326/804b2/residual-errors.png 384w\", \"/static/fe7b45127218fe99c3812c9543e7a326/e5715/residual-errors.png 768w\", \"/static/fe7b45127218fe99c3812c9543e7a326/4ad3a/residual-errors.png 1152w\", \"/static/fe7b45127218fe99c3812c9543e7a326/2cefc/residual-errors.png 1400w\"],\n    \"sizes\": \"(max-width: 768px) 100vw, 768px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Residual Errors\"), \"\\n  \"), mdx(\"p\", null, \"The decision tree, however, does not use gradient descent but rather, uses a different approach. Read on to find out more! \"), mdx(\"h4\", null, \"Decision Tree\"), mdx(\"p\", null, \"The decision tree regressor or classifier, as the name suggests, consists of a decision tree. Random forests are one of the most popular machine learning ensemble models. This stems from the versatile nature of decision trees, its white box nature and feature analysis capability. Understanding how decisions are being made within the decision tree can help establish which features are important. \"), mdx(\"p\", null, \"Decision trees essentially have an automatic feature selection process and features no longer require a standardisation process. \"), mdx(\"p\", null, \"This article is purposely limited and only discusses information gain. There are other key concepts to consider when creating a decision tree. Therefore, at the end of this article, I introduce concepts which will be the subject of future blogs. \"), mdx(\"h4\", null, \"Information Gain\"), mdx(\"p\", null, \"The \\u201Ctuning\\u201D of the decision trees does not use gradient descent to find its optimized parameters. Rather, it uses binary splits, for example, yes/no questions, greater than or less than values, to split the data at each node until the data reaches a leaf - this being the final target value. You may ask how does a model split the data efficiently? This is done by maximizing the information gain. \"), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"515px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/e39ba8ae22a8490eb37ac04a4c5f9cb0/fbdcb/Example-Decision-Tree.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAvklEQVQ4y72U2QqDMBBFT6PRxgWldqEPLXSDov//fyVwhdKHJmrpwBCSjNc5N1H4Q9TAHdgDHXAD2iWCGXAEGsABO6Ba2qWT8HauQALkEvF5VmcXYANY7Y81wahUmOrhlV4yjlaZyIoeeAIHjadPQTOBJlcDTg34+fq9wE8GnW6sYNC/LsIbK9xa/s4KL1KIotGd9L49tO6UhfCDUYoghrKMEZxyWCbmExyEE6K4yo6v2KkudRaB26rW/PzX8gKsvwT9sW6tyAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Example Decision Tree\",\n    \"title\": \"Example Decision Tree\",\n    \"src\": \"/static/e39ba8ae22a8490eb37ac04a4c5f9cb0/fbdcb/Example-Decision-Tree.png\",\n    \"srcSet\": [\"/static/e39ba8ae22a8490eb37ac04a4c5f9cb0/8514f/Example-Decision-Tree.png 192w\", \"/static/e39ba8ae22a8490eb37ac04a4c5f9cb0/804b2/Example-Decision-Tree.png 384w\", \"/static/e39ba8ae22a8490eb37ac04a4c5f9cb0/fbdcb/Example-Decision-Tree.png 515w\"],\n    \"sizes\": \"(max-width: 515px) 100vw, 515px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Example Decision Tree\"), \"\\n  \"), mdx(\"p\", null, \"The generic information gain formula, can be simplified into the information gain formula specific for binary splits, as shown here: \"), mdx(\"p\", null, \"$$\\nI\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"G (D_p, f) = I(D_p) - \\\\displaystyle \\\\sum\"), \"{j=1}^{m} \\\\frac{N\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"j}{N} I(D_j)  =  I(D_p) - \\\\rac{N\"), \"{left}}{N} I(D\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"{left}) - \\\\frac{N\"), \"{right}}{N} I(D_{right})\\n$$\"), mdx(\"p\", null, \"$ I_G $ is the information gain, $f$ is the feature to perform the split, $ D_p $ and $ D_j $ are the datasets for the parent and the $j^{th}$ child nodes, respectively. $N$ is the total number of samples, and $N_j$ is the number of samples within the $ j^{th} $ child node. $I$ is the impurity measure is a formula based on the selected splitting criteria.\"), mdx(\"p\", null, \"From the equation, it is clear that the impurity measure, $I$, aids in maximizing the information gain; meanwhile, the impurity measure for either the left, right or both, nodes need to be minimized. The two commonly used splitting criteria are the Gini Impurity and Entropy. \"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Another impurity measure, not discussed here, is the classification error, but this is not a recommended option for growing trees. This error is preferred for pruning rather than performing binary splits. \")), mdx(\"h4\", null, \"Entropy\"), mdx(\"p\", null, \"The term entropy does come up a lot, but this is very similar to the definition you would find in Physics! \"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Entropy is a measure of the energy dispersal within a system. Entropy is greater when there is more random movement within the molecules and zero when absolute zero. \")), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"768px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/5ff88ae935f50189da68ba9d0df8da6f/38af3/Thermodynamic-1st-law.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"47.39583333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABoUlEQVQoz22S224aMRCG95n7ElVeoKqq3ke9rtRUvakaJRJKmzQEWEgCKctpOS4QFq9P66+yKQglHcmeGc8/tuXPkVktkIMuapqiJkNkOkDPxqhsFnyIJ6Mw5DBBjQeUhcCbcyXOuX/xzkd+KrVCjxLMYoJdZTitODYv9s1HCy9qDlfuNo98YGYpZj5BjRJ02sdk08OJ/oZFO0bEN+hZetjI5mts/sxLi+xmjeo+oKdDzGIavG+26yVmOUfcXYU8v75gW62ENTXssjp9x+rTe1T/Cfu8Ynv5DT3oEqnkEWc0etSjuK+ip6MgKJq3iNsKovYTUf+FqFYo7u8Q1Ss252dkH96y/HhC/uML4vqS2ckb8vMzIrvdINsxMmmjxv1wunxqheuXqkA0f4dRPNQo4hucNQFKfvGV/PtnSrkDpHodSpET+Qf2byH/tLDzMTrthcIegq+ptIfsNAMsx2tzR5CifeJJi/EQvc4oyz3R/7UTiBqtscYctAfKPpFS0ul0qMUx9bhJvV4jTVOsta++jdcmSUKj0aDVahHHMVmWHXR/AZ94rHoCN4uOAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Thermodynamics 2nd Law\",\n    \"title\": \"Thermodynamics 2nd Law\",\n    \"src\": \"/static/5ff88ae935f50189da68ba9d0df8da6f/e5715/Thermodynamic-1st-law.png\",\n    \"srcSet\": [\"/static/5ff88ae935f50189da68ba9d0df8da6f/8514f/Thermodynamic-1st-law.png 192w\", \"/static/5ff88ae935f50189da68ba9d0df8da6f/804b2/Thermodynamic-1st-law.png 384w\", \"/static/5ff88ae935f50189da68ba9d0df8da6f/e5715/Thermodynamic-1st-law.png 768w\", \"/static/5ff88ae935f50189da68ba9d0df8da6f/38af3/Thermodynamic-1st-law.png 894w\"],\n    \"sizes\": \"(max-width: 768px) 100vw, 768px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Thermodynamics 2nd Law\"), \"\\n  \"), mdx(\"p\", null, \"Similarly, for machine learning, a larger entropy is observed when there is maximum randomness, such as predicting a head and tails coin toss - it is a complete chance! Meaning, when a binary split is performed using a feature that results in a large entropy it implies the feature, or threshold, is poor. \"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u2026 information gain, is simply the expected reduction in entropy caused by partitioning the examples according to this attribute. As quoted by \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.amazon.com/Learning-McGraw-Hill-International-Editions-Computer/dp/0071154671/ref=as_li_ss_tl?keywords=machine+learning&qid=1563151324&s=books&sr=1-44&linkCode=sl1&tag=inspiredalgor-20&linkId=5488f209b18fb6b8ad8ce7f72d1c3ac5&language=en_US\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"Tom M. Mitchell's book\"), \".\")), mdx(\"p\", null, \"Entropy impurity formula: \"), mdx(\"p\", null, \"$I\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"H (t) = -\\\\displaystyle \\\\sum\"), \"{i}^{C} p(i|t) log_2 p(i|t)$, for all valid classes meaning $p(i|t)$ cannot equal zero.\\n$p(i|t)$ is the proportion of the samples that belong to class $c$ for a particular node $t$. \"), mdx(\"p\", null, \"From looking at the formula:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"the entropy is $0$, when all samples at a node belong to the same class, and, \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"at its maximum when samples at a node belong to an uniform class distribution (i.e. 50-50).\")), mdx(\"p\", null, \"If you require a worked example, then i would highly recommend going through \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://machinelearningmastery.com/information-gain-and-mutual-information/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"this\"), \" worked example. \"), mdx(\"h4\", null, \"Gini\"), mdx(\"p\", null, \"Gini impurity is easier to understand and can be grasped by just looking at the Gini impurity formula: \"), mdx(\"p\", null, \"$$\\nI\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"G (t) = \\\\displaystyle \\\\sum\"), \"{i=1}^{C} p(i|t)( 1- p(i|t)) = 1 - \\\\displaystyle \\\\sum_{i=1}^{C} p(i|t)^2\\n$$\"), mdx(\"p\", null, \"From looking at the formula we can conclude:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"when $p(i|t)$ is minimized the gini impurity is far greater,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"the impurity is maximal if the classes are perfectly mixed, and,\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"minimize the probability of misclassification.\")), mdx(\"h4\", null, \"Conclusion\"), mdx(\"p\", null, \"Both of these formula are similar by using the $p(i|t)$ term but differ computational because of the additional logarithmic function. Moreover, from the formula we can see that the range of entropy lies in between 0 to 1 and the range of gini impurity lies in between 0 to 0.5. Therefore, we can conclude that gini impurity is most often superior compared to entropy for selecting the best features but as with all projects, it depends on the data you have. Most often the gini impurity and entropy performance is similar and does not warrant the additional time to train on both. \"), mdx(\"p\", null, \"Regardless of the impurity criteria selected, decision trees have an automatic feature selection process. Whereby, the impurity reduction has to be large enough to warrant the use of the feature. In a wider perspective, decision trees should be a small part of an ensemble model, either through gradient boosting, stacking, voting etc., as they independent from other gradient descent based models.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"em\", {\n    parentName: \"strong\"\n  }, \"Note: The Greek symbols may not render in your browser.\"))));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":4,"excerpt":"TLDR : Gini impurity and entropy are similar in most cases, however, in practice you may find that gini impurity is faster as log values do…","frontmatter":{"title":"Impurity Criterion","description":"Understanding the Decision Tree training process is key to being able to select whether your data requires the model to be trained using Entropy or Gini impurity Criterions.","cover":{"publicURL":"/static/5ff88ae935f50189da68ba9d0df8da6f/Thermodynamic-1st-law.png","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABxklEQVQoz2WSTW/TQBCG/c85cULihATigLgh9cAVCQlVIEQbEGlakdh1s07s1Haapk7ixPvh3fVb7bg2EYzknfHs7LPzsR6/mUAkDCJmEEnU2mlMtkpjcBbQntN8FkLeztEYDSdN0/S6sz1bK+jtA+r7HFZwWCnaIGvp6w84rTUaa1o/QWwP62zPigpyHqJe3qLOF9APqyegIW0Oe8gogC5WLfTpkk6Os6MM5c2YIHq9JKgILmF2G9p0IH41APcvcBh+h1pE5K+zBOXnj+Cjsx5UrzI0uoZn9jvKrE5j6M2agmV0DTEaQFxfQYR/UI3OUF38oH8+GqD8dILNuxfYvn+J6vwU1a9vKF49Q/XzK7z6LoXKYvDxb4jpGCqdUz9dXx2kA0k2AR8PYcodqvMvKF4/x/bkLVWmFjNsP7yhijwVTyETBr3fwfADZDyFVbLtX7mBCEZUMp8M6RInVilI5lNl/4rnFp3HsOkMJosBJbput0pr6OK+nz6OBnA0mX44nlsqIZEmCfIswzLPUZblf9PrDhpjsF6vKfZuuURRFLD27/PxOOeIoggT34fvB/B9H4xNCXr8LDq4g4VhiCAIwBgj2/m62EdSnfZ6TIqBTQAAAABJRU5ErkJggg=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/5ff88ae935f50189da68ba9d0df8da6f/84742/Thermodynamic-1st-law.png","srcSet":"/static/5ff88ae935f50189da68ba9d0df8da6f/58753/Thermodynamic-1st-law.png 224w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/4ca14/Thermodynamic-1st-law.png 447w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/84742/Thermodynamic-1st-law.png 894w","sizes":"(min-width: 894px) 894px, 100vw"},"sources":[{"srcSet":"/static/5ff88ae935f50189da68ba9d0df8da6f/5b7f4/Thermodynamic-1st-law.avif 224w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/192e6/Thermodynamic-1st-law.avif 447w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/df10b/Thermodynamic-1st-law.avif 894w","type":"image/avif","sizes":"(min-width: 894px) 894px, 100vw"},{"srcSet":"/static/5ff88ae935f50189da68ba9d0df8da6f/0fd18/Thermodynamic-1st-law.webp 224w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/1079e/Thermodynamic-1st-law.webp 447w,\n/static/5ff88ae935f50189da68ba9d0df8da6f/a49b6/Thermodynamic-1st-law.webp 894w","type":"image/webp","sizes":"(min-width: 894px) 894px, 100vw"}]},"width":894,"height":426}}},"coverAlt":"Thermodynamic 1st Law.","datePublished":"2021-02-26","dateModified":"2021-02-26","category":"Mathematics","tags":["Machine Learning","Mathematics"]},"fields":{"slug":"/impurity-criterion","route":"/impurity-criterion","pathName":"impurity-criterion","url":"https://ashishthanki.github.io/impurity-criterion"},"internal":{"content":"---\ntitle: \"Impurity Criterion\"\ncover: images/gini-vs-entropy/Thermodynamic-1st-law.png\ncoverAlt: \"Thermodynamic 1st Law.\"\ndescription: \"Understanding the Decision Tree training process is key to being able to select whether your data requires the model to be trained using Entropy or Gini impurity Criterions.\"\ndatePublished: \"2021-02-26\"\ndateModified: \"2021-02-26\"\ncategory: \"Mathematics\"\ntags:\n  - Machine Learning\n  - Mathematics\n---\n\n<!-- markdownlint-disable-->\n\n**TLDR**: Gini impurity and entropy are similar in most cases, however, in practice you may find that gini impurity is faster as log values do not need to be computed. \n\n##### Introduction\n\nMachine learning algorithms can be complex but in simple terms, training a machine learning model is essentially an optimization problem where training is performed to find model parameters (i.e. weights and hyperparameters) that reduce the cost function.\n\nThe cost function is the summation of the loss function across the entire dataset. The “loss” is the error from the true value (i.e. target) to the model’s predicted value, for example, the root mean squared error for regression or binary cross-entropy loss for classification problems. Obviously, the aim is to have a model that accurately predicts the target value for the majority of the dataset (or be as close to as possible for regression), therefore, the aim is to minimise the cost function tuning the weights using gradient descent. This is why training a machine learning model takes a while, especially for complex datasets that are within multiple dimensional spaces.\n\n\n![Residual Errors](./images/gini-vs-entropy/residual-errors.png)\n\nThe decision tree, however, does not use gradient descent but rather, uses a different approach. Read on to find out more! \n\n#### Decision Tree\nThe decision tree regressor or classifier, as the name suggests, consists of a decision tree. Random forests are one of the most popular machine learning ensemble models. This stems from the versatile nature of decision trees, its white box nature and feature analysis capability. Understanding how decisions are being made within the decision tree can help establish which features are important. \n\nDecision trees essentially have an automatic feature selection process and features no longer require a standardisation process. \n\nThis article is purposely limited and only discusses information gain. There are other key concepts to consider when creating a decision tree. Therefore, at the end of this article, I introduce concepts which will be the subject of future blogs. \n\n\n#### Information Gain\n\nThe “tuning” of the decision trees does not use gradient descent to find its optimized parameters. Rather, it uses binary splits, for example, yes/no questions, greater than or less than values, to split the data at each node until the data reaches a leaf - this being the final target value. You may ask how does a model split the data efficiently? This is done by maximizing the information gain. \n\n\n![Example Decision Tree](./images/gini-vs-entropy/Example-Decision-Tree.png)\n\nThe generic information gain formula, can be simplified into the information gain formula specific for binary splits, as shown here: \n\n$$\nI_G (D_p, f) = I(D_p) - \\displaystyle \\sum_{j=1}^{m} \\frac{N_j}{N} I(D_j)  =  I(D_p) - \\rac{N_{left}}{N} I(D_{left}) - \\frac{N_{right}}{N} I(D_{right})\n$$\n\n$ I_G $ is the information gain, $f$ is the feature to perform the split, $ D_p $ and $ D_j $ are the datasets for the parent and the $j^{th}$ child nodes, respectively. $N$ is the total number of samples, and $N_j$ is the number of samples within the $ j^{th} $ child node. $I$ is the impurity measure is a formula based on the selected splitting criteria.\n\nFrom the equation, it is clear that the impurity measure, $I$, aids in maximizing the information gain; meanwhile, the impurity measure for either the left, right or both, nodes need to be minimized. The two commonly used splitting criteria are the Gini Impurity and Entropy. \n\n> Another impurity measure, not discussed here, is the classification error, but this is not a recommended option for growing trees. This error is preferred for pruning rather than performing binary splits. \n\n\n#### Entropy\nThe term entropy does come up a lot, but this is very similar to the definition you would find in Physics! \n\n> Entropy is a measure of the energy dispersal within a system. Entropy is greater when there is more random movement within the molecules and zero when absolute zero. \n\n![Thermodynamics 2nd Law](./images/gini-vs-entropy/Thermodynamic-1st-law.png)\n\nSimilarly, for machine learning, a larger entropy is observed when there is maximum randomness, such as predicting a head and tails coin toss - it is a complete chance! Meaning, when a binary split is performed using a feature that results in a large entropy it implies the feature, or threshold, is poor. \n\n> … information gain, is simply the expected reduction in entropy caused by partitioning the examples according to this attribute. As quoted by [Tom M. Mitchell's book](https://www.amazon.com/Learning-McGraw-Hill-International-Editions-Computer/dp/0071154671/ref=as_li_ss_tl?keywords=machine+learning&qid=1563151324&s=books&sr=1-44&linkCode=sl1&tag=inspiredalgor-20&linkId=5488f209b18fb6b8ad8ce7f72d1c3ac5&language=en_US).\n\nEntropy impurity formula: \n\n$I_H (t) = -\\displaystyle \\sum_{i}^{C} p(i|t) log_2 p(i|t)$, for all valid classes meaning $p(i|t)$ cannot equal zero. \n$p(i|t)$ is the proportion of the samples that belong to class $c$ for a particular node $t$. \n\nFrom looking at the formula:\n\n- the entropy is $0$, when all samples at a node belong to the same class, and, \n- at its maximum when samples at a node belong to an uniform class distribution (i.e. 50-50).\n\nIf you require a worked example, then i would highly recommend going through [this](https://machinelearningmastery.com/information-gain-and-mutual-information/) worked example. \n\n\n#### Gini\n\nGini impurity is easier to understand and can be grasped by just looking at the Gini impurity formula: \n\n$$\nI_G (t) = \\displaystyle \\sum_{i=1}^{C} p(i|t)( 1- p(i|t)) = 1 - \\displaystyle \\sum_{i=1}^{C} p(i|t)^2\n$$\n\nFrom looking at the formula we can conclude:\n- when $p(i|t)$ is minimized the gini impurity is far greater,\n- the impurity is maximal if the classes are perfectly mixed, and,\n- minimize the probability of misclassification.\n\n#### Conclusion\n\nBoth of these formula are similar by using the $p(i|t)$ term but differ computational because of the additional logarithmic function. Moreover, from the formula we can see that the range of entropy lies in between 0 to 1 and the range of gini impurity lies in between 0 to 0.5. Therefore, we can conclude that gini impurity is most often superior compared to entropy for selecting the best features but as with all projects, it depends on the data you have. Most often the gini impurity and entropy performance is similar and does not warrant the additional time to train on both. \n\nRegardless of the impurity criteria selected, decision trees have an automatic feature selection process. Whereby, the impurity reduction has to be large enough to warrant the use of the feature. In a wider perspective, decision trees should be a small part of an ensemble model, either through gradient boosting, stacking, voting etc., as they independent from other gradient descent based models.\n\n***Note: The Greek symbols may not render in your browser.***\n\n"}}},"pageContext":{"slug":"/impurity-criterion","nexttitle":"Starting with Package Managers","nextslug":"/starting-with-package-managers","prevtitle":"Docker Devcontainers","prevslug":"/docker-devcontainers","relatedPosts":[{"title":"Model Drift and Concept Drift","description":"Maintaining a good in-production model requires understanding the understanding of model and concept drift.","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd1ORYA//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQEf/aAAgBAQABBQKaOI//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CKv8A/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERITFRQf/aAAgBAQABPyHNYn6IdFrWX1iQoP/aAAwDAQACAAMAAAAQA8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMXFBof/aAAgBAQABPxBVtSpsKgjtDxmHQ6xbodZwxdvtBMZ7P//Z"},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/c21aa3f5b54bbb6c20eefa63c18b5086/7acdb/degradation-point.jpg","srcSet":"/static/c21aa3f5b54bbb6c20eefa63c18b5086/76a0b/degradation-point.jpg 148w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/f5d63/degradation-point.jpg 295w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/7acdb/degradation-point.jpg 590w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/cc266/degradation-point.jpg 1180w","sizes":"(min-width: 590px) 590px, 100vw"},"sources":[{"srcSet":"/static/c21aa3f5b54bbb6c20eefa63c18b5086/8ec5f/degradation-point.avif 148w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/24e48/degradation-point.avif 295w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/23579/degradation-point.avif 590w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/630d8/degradation-point.avif 1180w","type":"image/avif","sizes":"(min-width: 590px) 590px, 100vw"},{"srcSet":"/static/c21aa3f5b54bbb6c20eefa63c18b5086/a168a/degradation-point.webp 148w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/6e9d7/degradation-point.webp 295w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/7b043/degradation-point.webp 590w,\n/static/c21aa3f5b54bbb6c20eefa63c18b5086/f3c07/degradation-point.webp 1180w","type":"image/webp","sizes":"(min-width: 590px) 590px, 100vw"}]},"width":590,"height":368},"coverImageAlt":"Deployed models have a degradation point and we need to avoid it!","datePublished":"2023-07-31T00:00:00.000Z","dateModified":"2023-07-31T00:00:00.000Z","category":"Ops","tags":["Machine Learning","DevOps"],"excerpt":"Model drift is a silent killer for in-production models and something that data scientists need to be mindful of. The importance of MLOps…","timeToRead":4,"slug":"/model-drift-and-concept-drift","route":"/model-drift-and-concept-drift","pathName":"/model-drift-and-concept-drift","url":"https://ashishthanki.github.io/model-drift-and-concept-drift"},{"title":"End to End Data Science Workflow","description":"The typical data science E2E workflow and pipeline.","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAPoAAAD6AG1e1JrAAADbklEQVQ4y5WS21MadxTH96/qax/iTKcPaaftU6cPtlNNO5NMk3aSmo4dUzQxahHiDUEu4u4ChusKi7C4sMslK7DAEnRZQNAoqUhrq2hbE9ndXwfodKYvNj1z3s58vmfO93ugcrms0WiMRiOGYVar1eFwAABkWQZvUNDFxYVGo9FqtQqFYmRkRK1W/w/49PQ0nU5zHMcwDE3TJEm2Wi0AgCiKkiT9B7yzsxMIBBAECQaDJEnCMMyy7Bsuh+r1+hqG0RRFU5TH7fL5vKEQUSqXtnm+KAiyJF+hAlWqVTOKEiRFkNFVO+Z0rsEr6FPkqR/z4phHFMWrNle3t0jbKuXSB2zqML4UWkdcOKz3ac0+hzUYKXLV5k/HvSt69S+4wbK8zbntHGGNn+X9t2KhO0Zs/BvvV6NunWKNMk2txomOBZLYBv+QstwTg+qlUmN/r76bE7KhMufdF+KlciqcDYTYZLZ2WCvUmy9P2h1KbkvglSi3uxK9GKBCgXfNh2m0GDXzKiT6MF2Z2qw+wVbWE2P24A+28EO9+V7coiDhsah1LLigTBvNofn5hMF4UK1CR80GMhzAhjl8KHP/tue9UPZdd+pt5eQDw7XvtX3DS9fuqt7yTbxjG+rbGO8L3X1//dbXcH9/8PMBXKWCXuy+jFiEnO+Ide1b8Jxxq27KNVAS90cX1xMGX1yP4YsZfDnnNyUcc2GTNotaUgjCmM3NgwPoRS1P4I88zlHcOxELzjJ+ZYZ4vLNFdn256sM6hvHPaffygN1w0274Qj320bTi+uyj65hz4fi3k929am231mqdACBJ4iWQRSBLQOq0LIkdWJaB1PVPAuDZxkLA8rHTNLAG9yNzH6wufpjAPilwse5YEiXQ60uxg8gygLq5/51+87BSKpB8PsJzRCrhz2fCxecJB/IjQ6FMBElGYYYyx0lzkkZSMZjecECSJJ+dvz5t/XnYOG4c/dr85ezn4/Pf/2hfivLFK+ns/LV+5ubK/KBuenB57kud6sbM+Kd69Q29elA3Owzt75WYgKLKLZXTqlJyUticqqRVXusQqrvjQe97rd/B2tte67f85nQhoeSiE2x4NEc9Tm88iEfsUOPwgCEm+c15PmUSMhaBRUsZ+BkxS7gnY8EnlE9J41NJckZgTcWUXkgby1mkkoPz8Tk+H/0LpmKVQKg7XHsAAAAASUVORK5CYII="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/c4dadd7c4934e3b8fb089c0df362eade/1198f/data-science-process.webp","srcSet":"/static/c4dadd7c4934e3b8fb089c0df362eade/4be21/data-science-process.webp 97w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/2061a/data-science-process.webp 194w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/1198f/data-science-process.webp 388w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/cfa69/data-science-process.webp 776w","sizes":"(min-width: 388px) 388px, 100vw"},"sources":[{"srcSet":"/static/c4dadd7c4934e3b8fb089c0df362eade/6ee32/data-science-process.avif 97w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/bfa01/data-science-process.avif 194w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/4a107/data-science-process.avif 388w,\n/static/c4dadd7c4934e3b8fb089c0df362eade/1ee87/data-science-process.avif 776w","type":"image/avif","sizes":"(min-width: 388px) 388px, 100vw"}]},"width":388,"height":368},"coverImageAlt":"E2E Pipeline","datePublished":"2023-07-15T00:00:00.000Z","dateModified":"2023-07-15T00:00:00.000Z","category":"Data Science","tags":["Machine Learning"],"excerpt":"The data science workflow can be cumbersome for beginners to handle and often some parts are forgotten completely, such as splitting the…","timeToRead":7,"slug":"/end-to-end-data-science-workflow","route":"/end-to-end-data-science-workflow","pathName":"end-to-end-data-science-workflow","url":"https://ashishthanki.github.io/end-to-end-data-science-workflow"}]}},
    "staticQueryHashes": ["3661114550"]}