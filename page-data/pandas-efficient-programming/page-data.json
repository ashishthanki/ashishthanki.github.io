{
    "componentChunkName": "component---themes-advanced-src-templates-post-query-ts",
    "path": "/pandas-efficient-programming",
    "result": {"data":{"mdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Pandas Efficient Programming\",\n  \"cover\": \"images/pandas-efficient-programming/pandas_python_logo.png\",\n  \"coverAlt\": \"A Pandas and Python Logos.\",\n  \"description\": \"Pandas is used daily but with just a few changes we can speed it up.\",\n  \"datePublished\": \"2021-10-03\",\n  \"dateModified\": \"2021-10-03\",\n  \"category\": \"Shorts\",\n  \"tags\": [\"Programming\", \"Pandas\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"The \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"Pandas\")), \" Python library is one of the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://insights.stackoverflow.com/survey/2020\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"most popular\"), \" open source data analysis and manipulation tools. It is used regularly, if not daily, by data scientists. It is extremely flexible, easy to use and fast with code paths written in Cython and C! The open source community has contributed massively to its development and created a tool that is able to form the foundation of loading, processing, and exporting datasets to many output formats.   \"), mdx(\"p\", null, \"Unsurprisingly, there is a downside. Pandas loads data in-memory, therefore, the size of the dataset or operations are limited by the available RAM. Some Pandas operations create intermediate copies* which further exacerbates the problem - although, it should be said this can be reduced by using alternative methods, such as \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iloc\"), \" or \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"loc\"), \", see \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"this\"), \" chapter, in order to index and select data efficiently.\"), mdx(\"p\", null, \"*\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"note this is different from the \", mdx(\"a\", {\n    parentName: \"em\",\n    \"href\": \"https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.copy.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \".copy()\")), \" function, which is used for another \", mdx(\"a\", {\n    parentName: \"em\",\n    \"href\": \"https://stackoverflow.com/a/27680109/14877533\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"reason\"), \".\")), mdx(\"h5\", null, \"Out-of-Core\"), mdx(\"p\", null, \"Fortunately, there are other open source libraries which have been modeled after pandas but has out-of-core and parallelization benefits. To name a few of these libraries: \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.rapids.ai/api\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"cuDF\")), \", \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.dask.org/en/latest/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"Dask\")), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://spark.apache.org/docs/latest/api/python/index.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"PySpark\")), \". However, many data scientist do not have the luxury of GPUs, firing up compute clusters, cloud computing or time to learn a new data manipulation package that might not have operations already within their existing workflow. They would be required to stick to their 8GB RAM and find an alternative way fast! \"), mdx(\"h4\", null, \"Use Chunking\"), mdx(\"p\", null, \"One possible solution involves \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/pandas-docs/stable/user_guide/scale.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"chunking data into smaller manageable pieces\"), \". You can chunk the data either row wise or column wise, if the later is used, then it may be worth saving your data in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.snowflake.com/guides/what-parquet\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"parquet\")), \" format instead of \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"csv\"), \" or \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"json\"), \". Have a read of \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://aws.amazon.com/blogs/big-data/top-10-performance-tuning-tips-for-amazon-athena/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"this\"), \" AWS blog post on how to tune your data.\"), mdx(\"p\", null, \"Chunking can become complex and result in convoluted code, especially if you are performing aggregation or complex operations within your dataset. This is particularly frustrating when you intend to plot your data but only can plot a small portion at a time (however, I would suggest columns not being used for the plot). If chunking is not for you then any single, combination, or, all of the following methods will reduce your RAM usage. \"), mdx(\"br\", null), mdx(\"h5\", null, \"1. Change Data Types\"), mdx(\"p\", null, \"From my experience, by far the biggest reduction is changing the data types (dtype) to more efficient values. I have summarized which data types are more efficient in the table below. \"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Previous Data Type\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"More Efficient Data type\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Float64\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Float32\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Float16\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Float32\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"String\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Categorical\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int64\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int32\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int16\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int8*\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int8\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"int4*\")))), mdx(\"p\", null, \"*\", \" If information is not lost then this is preferred, recall that each dtype stores the following: \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"int8 can store integers from -128 to 127.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"int16 can store integers from -32768 to 32767.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"int64 can store integers from -9223372036854775808 to 9223372036854775807.\")), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"py\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-py\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-py\"\n  }, \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"Column1 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"Column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"astype\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'int32'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\")))), mdx(\"br\", null), mdx(\"h5\", null, \"2. Use \", mdx(\"code\", {\n    parentName: \"h5\",\n    \"className\": \"language-text\"\n  }, \".to_numpy\"), \" method\"), mdx(\"p\", null, \"The \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \".to_numpy\"), \" method returns the dataframe, or series, into a Numpy representation - ndarray. Carrying out operations on your data using the Pandas data structures has shown to be \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://towardsdatascience.com/speed-testing-pandas-vs-numpy-ffbf80070ee7\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"slower than Numpy\"), \", regardless of the operation being row-wise or column-wise.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"py\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-py\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-py\"\n  }, \"numpy_values \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"Column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"to_numpy\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"# returns numpy array\"), \"\\nimaginary_func\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"numpy_values\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\")))), mdx(\"br\", null), mdx(\"h5\", null, \"3. Use \", mdx(\"code\", {\n    parentName: \"h5\",\n    \"className\": \"language-text\"\n  }, \"numba\"), \" JIT compiler\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://numba.pydata.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, mdx(\"code\", {\n    parentName: \"a\",\n    \"className\": \"language-text\"\n  }, \"Numba\")), \" is a Python package that is a just in time (JIT) compiler. It can speed up functions, loops and classes to run at machine code speed! The package has several decorators which can be applied to your functions to instruct Numba to compile them! I have discussed the two decorators out of the collection available: \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"@jit\"), \" and \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"@vectorize\"), \". \"), mdx(\"br\", null), mdx(\"h5\", null, mdx(\"strong\", {\n    parentName: \"h5\"\n  }, mdx(\"code\", {\n    parentName: \"strong\",\n    \"className\": \"language-text\"\n  }, \"@numba.jit\"))), mdx(\"p\", null, \"The decorator \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"@numba.jit\"), \" can be used to enable the speed up of a function that uses numpy operators or loops. There is no need to change the function just add the decorator on top and you're ready to go!\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"py\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-py\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-py\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"# @numba.jit\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"import\"), \" numba\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"import\"), \" math\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token decorator annotation punctuation\"\n  }, \"@numba\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"jit\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"def\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"square\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"x\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" x \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"**\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"2\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token decorator annotation punctuation\"\n  }, \"@numba\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"jit\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"def\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"pythagoras\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"a\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" b\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" math\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sqrt\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"square\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"a\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"+\"), \" square\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"b\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"def\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"compute_numba\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" column2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \"\\n  n \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"shape\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\n  result \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" np\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"empty\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" dtype\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'float64'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"assert\"), \" n \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token builtin\"\n  }, \"len\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token builtin\"\n  }, \"len\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"column2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"for\"), \" i \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"in\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token builtin\"\n  }, \"range\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"# numba will speed this up too!\"), \"\\n    result\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"i\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" pythagoras\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"i\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"column2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"i\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n  series_result \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" pd\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"Series\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"result\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" index\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"index\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" name\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'result'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" series_result\\n\\ncompute_numba\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'a'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" column\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'b'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"  \"))), mdx(\"p\", null, \"The \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"for\"), \" loop within the code above will also benefit from the speed boost introduced by the JIT compiler, as will the pythagoras and square function created. Although, one could argue there are faster solutions of this code.\"), mdx(\"br\", null), mdx(\"h5\", null, mdx(\"strong\", {\n    parentName: \"h5\"\n  }, mdx(\"code\", {\n    parentName: \"strong\",\n    \"className\": \"language-text\"\n  }, \"@numba.vectorize\"))), mdx(\"p\", null, \"The decorator \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"@numba.vectorize\"), \" allows us to write vectorized code without having to use a loop. The function will apply to every row automatically. \"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"py\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-py\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-py\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"# @numba.vectorize\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"import\"), \" numba\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token decorator annotation punctuation\"\n  }, \"@numba\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"vectorize\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"def\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"basic_function\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"column\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" column \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"*\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"2\"), \"\\n\\nbasic_function\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"df\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"Column1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"to_numpy\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"# huge speed gains observed\")))), mdx(\"p\", null, \"There are many more \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"numba\"), \" \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"http://numba.pydata.org/numba-doc/0.8/modules/decorators.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"decorators\"), \". In most cases your code will speed up, especially if you are using loops, however you may not observe any speed gains with native pandas operations because \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"numba\"), \" does not recognize these operations and is not able to convert it to machine code.\"), mdx(\"br\", null), mdx(\"h2\", null, \"Summary\"), mdx(\"p\", null, \"Once the dataset gets large enough it may no longer fit in memory but we can reduce this with the easy techniques described above. There are more options available that have not beed discussed here, such as out-of-core packages and more advanced methods in Pandas \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/pandas-docs/stable/user_guide/enhancingperf.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"Enhancing Performance\"), \". Pandas will continue to grow in popularity with more operations being added by the large contribution from the open source community, which is why its crucial to learn how to speed it up with only minor code changes!  \"), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"768px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/55cdba9bdd93a2821de02385cbff81b0/2bef9/pandas_popularity_growth.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"100%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtElEQVQ4y51UyZLbIBDV/39OrnOZyiWXZOJ1vI01lm1hLTa2ViQEvBRgbGucXNJVXVAN/eh+3bQHAHVdYzAYYDwe4+3tDbPZDMPh0Kzarvf6TO8f761WKywWC4xGI4OhxVNKgTGG0+mE8/lslFJqVNvcmqapWZ1mWQYnyqlS8IQQaJoG/yNSSqOqayFYafbe06FST/t/2ZQClBAQsQ9RUqg+oIKQ0qZgnNQX57vae8qmWWdAkVz9JDztwLvuygLAuAVwIoR9RF7BHGvOXqcEy02CJOc25SiKIEUHWrQIKcMoKEBogyTT2hrnknU3kKziqJoOoyDHZFfifb5BUVQQ0mbjxXFsXqIlR5DWqFuBYZBjf7Lg2nG0LTDdlZiTEr/8DMtDiVPRIaIVeBzYmK8UeUmSPBQfvX3BOlwqbi6GtDGRdkJCd4aRJkd0mGJXpWCCGVY9QsitgjqlPvEW/JG7W6EkkIcTfBw2OJIL6DlDy7gF5Jz32sKpvAL32sY9dAkx/fiBtR9BtAJVxsDbzgJ+7cMe6AMgpI30cAnwc/iKwWiNtmh7NJkqPwK6PnxO3bosiY/vL99w3B9RV81TMAZQk+yMVpWpmhPecazSHcarOX6/vqCKj7dGdvy6LDzNX9u29sAd6p5TAmVbYrb7xHjl432yQL6aAor3/rP21wVhzEZ7+3oasOIVCI0x933MN5+YB3sc9jGQx0BGIJsSrZDI8wLhIcaeRAh2BCd6AbsOGM+FnNcV/PAAEp2RXWqwvEIThzivxwg3a5CUYk9ibPcEcXJEXpQoqxqPARkOu64zf7mkFLvJEMn6HeHHDNvFBNvlFMcTRVk3yPL83tB/GWG3ouhLmgfeMlzSCAVNIZq65/AVQHMuHyaSVtfL9/GljZ3opSCFuI12Pcn1ZDcTibHeRHI2DfgHJwUMVnmvPx8AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Pandas Popularity\",\n    \"title\": \"Pandas Popularity\",\n    \"src\": \"/static/55cdba9bdd93a2821de02385cbff81b0/e5715/pandas_popularity_growth.png\",\n    \"srcSet\": [\"/static/55cdba9bdd93a2821de02385cbff81b0/8514f/pandas_popularity_growth.png 192w\", \"/static/55cdba9bdd93a2821de02385cbff81b0/804b2/pandas_popularity_growth.png 384w\", \"/static/55cdba9bdd93a2821de02385cbff81b0/e5715/pandas_popularity_growth.png 768w\", \"/static/55cdba9bdd93a2821de02385cbff81b0/2bef9/pandas_popularity_growth.png 1024w\"],\n    \"sizes\": \"(max-width: 768px) 100vw, 768px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Pandas Popularity\"), \"\\n  \"), mdx(\"h4\", null, \"Further Reading and Other Tips\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"df.info(deep_memory=True)\"), \", returns the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.info.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"memory usage\"), \" of the dataframe.  \")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Do not use the \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"apply\"), \" method, a detailed discussion \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://stackoverflow.com/a/54432584/14877533\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"here\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Use \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"%%time\"), \" \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"magic\"), \", to time operations within a jupyter cell. \")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Look up Ian Ozsvald's O'Reilly \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.amazon.com/High-Performance-Python-Performant-Programming-ebook/dp/B087YTVL8F/ref=sr_1_1?crid=2TWHW4LRAIEP6&dchild=1&keywords=high+performance+python&qid=1590482442&sprefix=high+performance+pyt%2Caps%2C232&sr=8-1\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"book\"), \" and his PyData videos \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.youtube.com/watch?v=N4pj3CS857c&t=3s\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"Making Pandas Fly\"), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.youtube.com/watch?v=I1xyjc-JgGM&t=1536s\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"Tools for High Performance\")))));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":3,"excerpt":"The  Pandas  Python library is one of the  most popular  open source data analysis and manipulation tools. It is used regularly, if not…","frontmatter":{"title":"Pandas Efficient Programming","description":"Pandas is used daily but with just a few changes we can speed it up.","cover":{"publicURL":"/static/9ff9acd6ae58a070105d75087de00329/pandas_python_logo.png","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQY032Qy0sCURTG568J2kUEQdAuWkarNhG2axERFEEIQYtACcMIQaeU0qQXkmAPsac1OpiPTTiTWVbkY64Zk4kOd0a9J6ZSKKLf4vCdw8fHOYcSRVGWFYyx/BOM5eYQqy0W3yve2OO6n0ukC7UqxhhT5XIZAIhKs34J0mzrdQIA0YfCqI1pHXNojAfwCZXLvrDsbYDhFbnaSFGtilItFr9zAcB+kdSYTvv1++3jzr7Z7VpaBxJPedzntN5st5xFI3dLCx4bfWzQuVetJ8Z598y002rxra0cobdKp3a3Y2p7yLA5MLdm2tmAeBfJLFLL9KFRu8X6rplLzrsXDYeSjD+e4NOMnwsyPBtIBC/ir8Vy26RrcccBhZFaahDu+iHcAlmaCod4jnsulSRCyNdtzVUbGgDqLjZzFbFBsltJDFeTEyRDE5ynJEn65f4DUldrJQY3PcD1gmAGIqsPS6VSCOUFQUD/ks0JqueJRfdelI4jJCCU+wAdQZkB/4EtQwAAAABJRU5ErkJggg=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/9ff9acd6ae58a070105d75087de00329/adf58/pandas_python_logo.png","srcSet":"/static/9ff9acd6ae58a070105d75087de00329/12630/pandas_python_logo.png 120w,\n/static/9ff9acd6ae58a070105d75087de00329/1f44d/pandas_python_logo.png 241w,\n/static/9ff9acd6ae58a070105d75087de00329/adf58/pandas_python_logo.png 481w","sizes":"(min-width: 481px) 481px, 100vw"},"sources":[{"srcSet":"/static/9ff9acd6ae58a070105d75087de00329/04a39/pandas_python_logo.avif 120w,\n/static/9ff9acd6ae58a070105d75087de00329/d50d7/pandas_python_logo.avif 241w,\n/static/9ff9acd6ae58a070105d75087de00329/a21d2/pandas_python_logo.avif 481w","type":"image/avif","sizes":"(min-width: 481px) 481px, 100vw"},{"srcSet":"/static/9ff9acd6ae58a070105d75087de00329/98342/pandas_python_logo.webp 120w,\n/static/9ff9acd6ae58a070105d75087de00329/cf801/pandas_python_logo.webp 241w,\n/static/9ff9acd6ae58a070105d75087de00329/fdd8b/pandas_python_logo.webp 481w","type":"image/webp","sizes":"(min-width: 481px) 481px, 100vw"}]},"width":481,"height":201}}},"coverAlt":"A Pandas and Python Logos.","datePublished":"2021-10-03","dateModified":"2021-10-03","category":"Shorts","tags":["Programming","Pandas"]},"fields":{"slug":"/pandas-efficient-programming","route":"/pandas-efficient-programming","pathName":"pandas-efficient-programming","url":"https://ashishthanki.github.io/pandas-efficient-programming"},"internal":{"content":"---\ntitle: \"Pandas Efficient Programming\"\ncover: images/pandas-efficient-programming/pandas_python_logo.png\ncoverAlt: \"A Pandas and Python Logos.\"\ndescription: \"Pandas is used daily but with just a few changes we can speed it up.\"\ndatePublished: \"2021-10-03\"\ndateModified: \"2021-10-03\"\ncategory: \"Shorts\"\ntags:\n  - Programming\n  - Pandas\n---\n\n<!-- markdownlint-disable-->\n\n\nThe [`Pandas`](https://pandas.pydata.org/) Python library is one of the [most popular](https://insights.stackoverflow.com/survey/2020) open source data analysis and manipulation tools. It is used regularly, if not daily, by data scientists. It is extremely flexible, easy to use and fast with code paths written in Cython and C! The open source community has contributed massively to its development and created a tool that is able to form the foundation of loading, processing, and exporting datasets to many output formats.   \n\nUnsurprisingly, there is a downside. Pandas loads data in-memory, therefore, the size of the dataset or operations are limited by the available RAM. Some Pandas operations create intermediate copies* which further exacerbates the problem - although, it should be said this can be reduced by using alternative methods, such as `iloc` or `loc`, see [this](https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html) chapter, in order to index and select data efficiently.\n\n**note this is different from the [`.copy()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.copy.html) function, which is used for another [reason](https://stackoverflow.com/a/27680109/14877533).*\n\n\n##### Out-of-Core\n\nFortunately, there are other open source libraries which have been modeled after pandas but has out-of-core and parallelization benefits. To name a few of these libraries: [`cuDF`](https://docs.rapids.ai/api), [`Dask`](https://docs.dask.org/en/latest/) and [`PySpark`](https://spark.apache.org/docs/latest/api/python/index.html). However, many data scientist do not have the luxury of GPUs, firing up compute clusters, cloud computing or time to learn a new data manipulation package that might not have operations already within their existing workflow. They would be required to stick to their 8GB RAM and find an alternative way fast! \n\n\n#### Use Chunking \n\nOne possible solution involves [chunking data into smaller manageable pieces](https://pandas.pydata.org/pandas-docs/stable/user_guide/scale.html). You can chunk the data either row wise or column wise, if the later is used, then it may be worth saving your data in [`parquet`](https://www.snowflake.com/guides/what-parquet) format instead of `csv` or `json`. Have a read of [this](https://aws.amazon.com/blogs/big-data/top-10-performance-tuning-tips-for-amazon-athena/) AWS blog post on how to tune your data.\n\nChunking can become complex and result in convoluted code, especially if you are performing aggregation or complex operations within your dataset. This is particularly frustrating when you intend to plot your data but only can plot a small portion at a time (however, I would suggest columns not being used for the plot). If chunking is not for you then any single, combination, or, all of the following methods will reduce your RAM usage. \n\n<br/> \n\n##### 1. Change Data Types\n\nFrom my experience, by far the biggest reduction is changing the data types (dtype) to more efficient values. I have summarized which data types are more efficient in the table below. \n\n\n| Previous Data Type | More Efficient Data type |\n| ------ | ---------------------------------------- |\n| Float64 | Float32 |\n| Float16 | Float32 |\n| String | Categorical |\n| int64 | int32 |\n| int16 | int8* |\n| int8 | int4* |\n\n\\* If information is not lost then this is preferred, recall that each dtype stores the following: \n- int8 can store integers from -128 to 127.\n- int16 can store integers from -32768 to 32767.\n- int64 can store integers from -9223372036854775808 to 9223372036854775807.\n\n```py\ndf.Column1 = df.Column1.astype('int32')\n```\n\n<br/> \n\n##### 2. Use `.to_numpy` method\n\nThe `.to_numpy` method returns the dataframe, or series, into a Numpy representation - ndarray. Carrying out operations on your data using the Pandas data structures has shown to be [slower than Numpy](https://towardsdatascience.com/speed-testing-pandas-vs-numpy-ffbf80070ee7), regardless of the operation being row-wise or column-wise.\n\n```py\nnumpy_values = df.Column1.to_numpy() # returns numpy array\nimaginary_func(numpy_values)\n```\n\n<br/> \n\n##### 3. Use `numba` JIT compiler\n\n[`Numba`](http://numba.pydata.org/) is a Python package that is a just in time (JIT) compiler. It can speed up functions, loops and classes to run at machine code speed! The package has several decorators which can be applied to your functions to instruct Numba to compile them! I have discussed the two decorators out of the collection available: `@jit` and `@vectorize`. \n\n<br/>\n\n##### **`@numba.jit`**\n\nThe decorator `@numba.jit` can be used to enable the speed up of a function that uses numpy operators or loops. There is no need to change the function just add the decorator on top and you're ready to go!\n\n```py\n# @numba.jit\nimport numba\nimport math\n\n@numba.jit\ndef square(x):\n    return x ** 2\n\n@numba.jit\ndef pythagoras(a, b):\n  return math.sqrt(square(a) + square(b))\n\ndef compute_numba(df, column1, column2):\n  n = df.shape[0]\n  result = np.empty(n, dtype='float64')\n  assert n == len(df.column1) == len(df.column2)\n  for i in range(n): # numba will speed this up too!\n    result[i] = pythagoras(df.column1[i], df.column2[i])\n  series_result = pd.Series(result, index=df.index, name='result')\n  return series_result\n\ncompute_numba(df, column1='a', column='b')  \n```\nThe `for` loop within the code above will also benefit from the speed boost introduced by the JIT compiler, as will the pythagoras and square function created. Although, one could argue there are faster solutions of this code.\n\n<br/> \n\n##### **`@numba.vectorize`**\n\nThe decorator `@numba.vectorize` allows us to write vectorized code without having to use a loop. The function will apply to every row automatically. \n\n```py\n# @numba.vectorize\nimport numba\n\n@numba.vectorize\ndef basic_function(column):\n  return column * 2\n\nbasic_function(df.Column1.to_numpy()) # huge speed gains observed\n```\n\nThere are many more `numba` [decorators](http://numba.pydata.org/numba-doc/0.8/modules/decorators.html). In most cases your code will speed up, especially if you are using loops, however you may not observe any speed gains with native pandas operations because `numba` does not recognize these operations and is not able to convert it to machine code.\n\n<br/> \n\n## Summary \n\nOnce the dataset gets large enough it may no longer fit in memory but we can reduce this with the easy techniques described above. There are more options available that have not beed discussed here, such as out-of-core packages and more advanced methods in Pandas [Enhancing Performance](https://pandas.pydata.org/pandas-docs/stable/user_guide/enhancingperf.html). Pandas will continue to grow in popularity with more operations being added by the large contribution from the open source community, which is why its crucial to learn how to speed it up with only minor code changes!  \n\n![Pandas Popularity](./images/pandas-efficient-programming/pandas_popularity_growth.png)\n\n\n#### Further Reading and Other Tips\n\n1. `df.info(deep_memory=True)`, returns the [memory usage](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.info.html) of the dataframe.  \n\n2. Do not use the `apply` method, a detailed discussion [here](https://stackoverflow.com/a/54432584/14877533).\n\n3. Use `%%time` [magic](https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit), to time operations within a jupyter cell. \n\n4. Look up Ian Ozsvald's O'Reilly [book](https://www.amazon.com/High-Performance-Python-Performant-Programming-ebook/dp/B087YTVL8F/ref=sr_1_1?crid=2TWHW4LRAIEP6&dchild=1&keywords=high+performance+python&qid=1590482442&sprefix=high+performance+pyt%2Caps%2C232&sr=8-1) and his PyData videos [Making Pandas Fly](https://www.youtube.com/watch?v=N4pj3CS857c&t=3s) and [Tools for High Performance](https://www.youtube.com/watch?v=I1xyjc-JgGM&t=1536s)\n"}}},"pageContext":{"slug":"/pandas-efficient-programming","nexttitle":"Interpreting ML Models Part 2","nextslug":"/interpreting-ml-models-part-2","prevtitle":"Natural Language Processing","prevslug":"/natural-language-processing","relatedPosts":[{"title":"Pandas Efficient Programming","description":"Pandas is used daily but with just a few changes we can speed it up.","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVQY032Qy0sCURTG568J2kUEQdAuWkarNhG2axERFEEIQYtACcMIQaeU0qQXkmAPsac1OpiPTTiTWVbkY64Zk4kOd0a9J6ZSKKLf4vCdw8fHOYcSRVGWFYyx/BOM5eYQqy0W3yve2OO6n0ukC7UqxhhT5XIZAIhKs34J0mzrdQIA0YfCqI1pHXNojAfwCZXLvrDsbYDhFbnaSFGtilItFr9zAcB+kdSYTvv1++3jzr7Z7VpaBxJPedzntN5st5xFI3dLCx4bfWzQuVetJ8Z598y002rxra0cobdKp3a3Y2p7yLA5MLdm2tmAeBfJLFLL9KFRu8X6rplLzrsXDYeSjD+e4NOMnwsyPBtIBC/ir8Vy26RrcccBhZFaahDu+iHcAlmaCod4jnsulSRCyNdtzVUbGgDqLjZzFbFBsltJDFeTEyRDE5ynJEn65f4DUldrJQY3PcD1gmAGIqsPS6VSCOUFQUD/ks0JqueJRfdelI4jJCCU+wAdQZkB/4EtQwAAAABJRU5ErkJggg=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/9ff9acd6ae58a070105d75087de00329/adf58/pandas_python_logo.png","srcSet":"/static/9ff9acd6ae58a070105d75087de00329/12630/pandas_python_logo.png 120w,\n/static/9ff9acd6ae58a070105d75087de00329/1f44d/pandas_python_logo.png 241w,\n/static/9ff9acd6ae58a070105d75087de00329/adf58/pandas_python_logo.png 481w","sizes":"(min-width: 481px) 481px, 100vw"},"sources":[{"srcSet":"/static/9ff9acd6ae58a070105d75087de00329/04a39/pandas_python_logo.avif 120w,\n/static/9ff9acd6ae58a070105d75087de00329/d50d7/pandas_python_logo.avif 241w,\n/static/9ff9acd6ae58a070105d75087de00329/a21d2/pandas_python_logo.avif 481w","type":"image/avif","sizes":"(min-width: 481px) 481px, 100vw"},{"srcSet":"/static/9ff9acd6ae58a070105d75087de00329/98342/pandas_python_logo.webp 120w,\n/static/9ff9acd6ae58a070105d75087de00329/cf801/pandas_python_logo.webp 241w,\n/static/9ff9acd6ae58a070105d75087de00329/fdd8b/pandas_python_logo.webp 481w","type":"image/webp","sizes":"(min-width: 481px) 481px, 100vw"}]},"width":481,"height":201},"coverImageAlt":"A Pandas and Python Logos.","datePublished":"2021-10-03T00:00:00.000Z","dateModified":"2021-10-03T00:00:00.000Z","category":"Shorts","tags":["Programming","Pandas"],"excerpt":"The  Pandas  Python library is one of the  most popular  open source data analysis and manipulation tools. It is used regularly, if not…","timeToRead":3,"slug":"/pandas-efficient-programming","route":"/pandas-efficient-programming","pathName":"pandas-efficient-programming","url":"https://ashishthanki.github.io/pandas-efficient-programming"},{"title":"Sequences","description":"Interesting facts about sequences.","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQoz22Sa4+qMBCG+f//yBi0IBpvYbNlQQG13YCFovRQ5GK57lnJMVn3vB+adtInM/POSJcoMgzDtu2De0h40j+UpjcIoeO6+POzqqqu6/p/Gu6+769WK8m29+PxWNO0iSw7jjP8CIJgOp1qs5kCAISwrusB67qubdu+7w3DGI1GUhiGQRB+fJhhGBJCMMac8yRJPM+DEB6ORxpFA/xUVVUAgOVyKXHOWRxjjOM4zvOcMUYpzfO8LAqE0J8kybLser0OccaYECKOY1VVFUWR0jS9RJFtO5TSsiy/n5eLEOJ+v9MwzLKsLEtKqWWZ2ny+2+0IIQCA7XarqqpUFIUQd0JIXhRVVfE0pVH0NGY467o+nY66riOEEUKLxWK9XmuaJrVt2zRN13XNozHO+fl8fho7wEIIhE66/oYRnkwm+/3ecRxZlqX+p263W/TI/OIQxkjX38iZKIqy2WxM0wQAvMKc8yAIXoJCiIPrrtcbwzAghFmW+b7/3fPvJHmev6yEEGK3s2Yz7f0dUkrbtrUsaz6fv8L/VdM0jDHP8xhjw8xd1/1b9hdrdF5Ra9pVhAAAAABJRU5ErkJggg=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/static/2cd573256a0995569f582e2a20c24f07/8fccb/array_vs_list.png","srcSet":"/static/2cd573256a0995569f582e2a20c24f07/a8fd2/array_vs_list.png 165w,\n/static/2cd573256a0995569f582e2a20c24f07/38e56/array_vs_list.png 330w,\n/static/2cd573256a0995569f582e2a20c24f07/8fccb/array_vs_list.png 660w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/2cd573256a0995569f582e2a20c24f07/79731/array_vs_list.avif 165w,\n/static/2cd573256a0995569f582e2a20c24f07/6ae0f/array_vs_list.avif 330w,\n/static/2cd573256a0995569f582e2a20c24f07/a7415/array_vs_list.avif 660w","type":"image/avif","sizes":"(min-width: 660px) 660px, 100vw"},{"srcSet":"/static/2cd573256a0995569f582e2a20c24f07/55a9a/array_vs_list.webp 165w,\n/static/2cd573256a0995569f582e2a20c24f07/39687/array_vs_list.webp 330w,\n/static/2cd573256a0995569f582e2a20c24f07/14a96/array_vs_list.webp 660w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":368},"coverImageAlt":"Arrays vs Lists in memory","datePublished":"2023-01-14T00:00:00.000Z","dateModified":"2023-02-10T00:00:00.000Z","category":"Shorts","tags":["Programming","Python"],"excerpt":"I recently started to re-learn parts of Python, and wanted to write this  shorts  blog post on a few interesting things I have learnt. Lists…","timeToRead":3,"slug":"/sequences","route":"/sequences","pathName":"/sequences","url":"https://ashishthanki.github.io/sequences"}]}},
    "staticQueryHashes": ["3661114550"]}